---
title: "Agent Teams 与多代理系统 — 常见问题"
description: "关于 Claude Code Agent Teams 和多代理架构的常见问题"
date: 2026-02-10
lang: zh
---

### 什么是 Claude Code 的 Agent Teams？

Agent Teams 是随 Claude Opus 4.6 推出的功能，允许多个 AI 代理在 Claude Code 中同时协作处理一个项目。不再是单一代理顺序工作，而是可以启动多个专门化代理并行运作：

* **主导代理**：协调整体计划并分配任务
* **执行代理**：完成具体子任务（编码、测试、审查、文档）
* **各代理拥有独立上下文**：代理不共享单一上下文窗口，通过结构化交接进行通信

这类似于人类开发团队的工作方式——技术负责人将功能拆分为任务并分配给专家。Agent Teams 在处理复杂项目时比单一代理显著更快。

---

### 如何设置 Agent Teams？

在 Claude Code 中设置 Agent Teams 的步骤：

1. **定义角色**：为每个代理角色创建技能文件
2. **指定协调方式**：定义代理间如何通信和交接工作
3. **启动团队**：使用 Claude Code 的团队模式启动多个代理
4. **监控进度**：主导代理报告整体状态，可查看各代理进度

示例团队配置：
* 代理 1（实现者）：编写新功能代码
* 代理 2（测试编写者）：并行创建单元测试和集成测试
* 代理 3（文档编写者）：随实现进展更新文档
* 主导代理：协调、解决冲突、确保一致性

关键是清晰的角色定义和结构化的交接协议。

---

### Agent Teams 的使用场景有哪些？

Agent Teams 擅长天然可并行化的任务：

* **功能开发**：一个代理实现功能，一个写测试，一个处理文档
* **代码重构**：多个代理同时重构不同模块
* **迁移项目**：代理并行迁移不同的服务或文件
* **代码审查**：一个代理审查逻辑，一个审查安全，一个审查性能
* **全栈功能**：前端代理 + 后端代理 + 数据库代理协同工作

不太适合 Agent Teams 的场景：高度顺序的任务、小而快的任务（协调开销超过收益）、需要深度理解单一问题的任务。

---

### Agent Teams 之间如何通信？

代理通过结构化交接机制通信，而非自由对话：

* **基于文件的通信**：代理读写共享文件（代码、文档、配置）
* **任务完成信号**：代理在子任务完成时发出信号
* **产物传递**：一个代理的输出成为另一个代理的输入
* **主导代理协调**：主导代理读取所有工作者的状态并做出决策

代理之间不会互相"聊天"。协调更像 CI/CD 管道——定义明确的交接，输入输出清晰。这比非结构化的代理间对话更可靠。

---

### Agent Teams 与单代理工作流相比如何？

| 方面 | 单代理 | Agent Teams |
|------|--------|-------------|
| 速度 | 顺序执行 | 多任务并行 |
| 上下文 | 一个大上下文窗口 | 多个小上下文 |
| 复杂度 | 设置简单 | 需要角色定义和协调 |
| 成本 | 较低 | 较高（多个代理运行） |
| 适合 | 专注的顺序任务 | 复杂的可并行项目 |

Agent Teams 在复杂项目（10+ 文件变更）上通常展现 **2-4 倍加速**，但对简单任务增加约 20% 开销。

---

### 什么是更广义的多代理架构？

除了 Claude Code 的 Agent Teams，多代理架构是一种软件设计模式：

* **水平式**：相同能力的代理处理不同工作部分（扩展性）
* **垂直式**：不同专长的代理形成流水线（质量）
* **层级式**：管理代理委派给工作代理（协调）

支持多代理系统的框架包括 Claude Code Agent Teams、LangGraph、AutoGen、CrewAI 等。2026 年的趋势是层级式多代理系统。

---

### Agent Teams 的成本是多少？

Agent Teams 因多个代理同时运行而成倍增加 API 成本：

* **单代理会话**（1 小时，Opus 4.6）：约 $2-10
* **3 代理团队**（1 小时）：约 $6-30
* **5 代理团队**（1 小时）：约 $10-50

优化方式：简单角色使用便宜模型（Sonnet、Haiku），只对主导代理和复杂任务使用 Opus，启用共享上下文的提示缓存，设定明确的停止条件。

尽管绝对成本更高，Agent Teams 的单位工作成本效益可能更好，因为完成更快且避免了长单代理会话中的上下文窗口频繁切换。

---

### 多代理系统的挑战有哪些？

常见挑战：

* **合并冲突**：两个代理同时编辑同一文件
* **不一致性**：代理做出互不兼容的设计决策
* **协调开销**：花在交接上的时间多于生产性工作
* **调试困难**：跨多个代理追踪问题更难
* **成本不可预测**：多代理可能快速增加成本

缓解策略：为每个代理分配明确的文件所有权、通过共享 CLAUDE.md 统一编码规范、用主导代理做最终一致性检查、设置成本预算和监控告警。

---

### Agent Teams 可以使用 MCP 吗？

可以，Agent Teams 可以利用 MCP（模型上下文协议）连接外部工具和数据源。团队中的每个代理可以访问不同的 MCP 服务器：

* **实现代理**：连接 GitHub、数据库 schema 工具
* **审查代理**：连接安全扫描工具、代码检查服务
* **运维代理**：连接云服务商、监控面板

MCP 使代理能够与文件系统和终端之外的真实系统交互，让 Agent Teams 在端到端开发工作流中显著更强大。

---

### Agent Teams 的未来发展方向？

2026-2027 年预期发展：

* **持久化团队**：持续运行，监控和改进代码库的代理团队
* **跨模型团队**：在一个团队中混合 Claude、GPT 和 Gemini 代理
* **自组织团队**：代理根据需要动态创建子代理
* **人机混合团队**：人类开发者和 AI 代理之间的无缝交接
* **标准化协议**：基于 MCP 的行业标准代理通信格式

愿景是 AI 代理成为开发团队的一等成员，拥有特定角色和职责。
